<html>
<head>
<title>DataUniformZipfianGenerator.java</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.ln { color: rgb(0,0,0); font-weight: normal; font-style: normal; }
.s0 { color: rgb(0,0,128); font-weight: bold; }
.s1 { }
.s2 { color: rgb(0,128,0); font-weight: bold; }
.s3 { color: rgb(128,128,128); font-style: italic; }
.s4 { color: rgb(0,0,255); }
</style>
</head>
<BODY BGCOLOR="#ffffff">
<TABLE CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#C0C0C0" >
<TR><TD><CENTER>
<FONT FACE="Arial, Helvetica" COLOR="#000000">
DataUniformZipfianGenerator.java</FONT>
</center></TD></TR></TABLE>
<pre>

<span class="s0">import </span><span class="s1">com.yahoo.ycsb.generator.UniformIntegerGenerator; 
</span><span class="s0">import </span><span class="s1">com.yahoo.ycsb.generator.ZipfianGenerator; 
</span><span class="s0">import </span><span class="s1">java.sql.*; 
 
</span><span class="s0">public class </span><span class="s1">DataUniformZipfianGenerator 
{ 
    </span><span class="s0">public static void </span><span class="s1">main(String[] args) 
      </span><span class="s0">throws </span><span class="s1">Exception { 
 
 
        String jdbcUrl = 
             </span><span class="s2">&quot;jdbc:oracle:thin:@ldap://oid.its.yale.edu:389/HOP7,CN=OracleContext,dc=world&quot;</span><span class="s1">; 
        String user = </span><span class="s2">&quot;ap349&quot;</span><span class="s1">; 
        String password = </span><span class="s2">&quot;dba911&quot;</span><span class="s1">; 
 
        Class.forName(</span><span class="s2">&quot;oracle.jdbc.driver.OracleDriver&quot;</span><span class="s1">); 
        Connection connection = DriverManager.getConnection(jdbcUrl, user, password); 
        connection.setAutoCommit(</span><span class="s0">false</span><span class="s1">); 
 
        Statement statement = connection.createStatement(); 
        statement.execute(</span><span class="s2">&quot;truncate table sales&quot;</span><span class="s1">); 
 
        String sql = </span><span class="s2">&quot;insert into sales</span><span class="s0">\n</span><span class="s2">&quot; </span><span class="s1">+ 
                </span><span class="s2">&quot;  ( year, amount )</span><span class="s0">\n</span><span class="s2">&quot; </span><span class="s1">+ 
                </span><span class="s2">&quot;   values</span><span class="s0">\n</span><span class="s2">&quot; </span><span class="s1">+ 
                </span><span class="s2">&quot;  ( add_months(to_date('01-JAN-1980','dd-mon-yyyy'), 12*(:1) ), :2 )&quot;</span><span class="s1">; 
        PreparedStatement ps = connection.prepareStatement(sql); 
 
        </span><span class="s3">// Using the data generator code from Yahoo labs at</span><span class="s1"> 
        </span><span class="s3">// https://github.com/brianfrankcooper/YCSB/tree/master/core/src/main/java/com/yahoo/ycsb/generator</span><span class="s1"> 
 
        </span><span class="s3">// UniformIntegerGenerator generates uniformly and linearly distributed integers between lowerBound</span><span class="s1"> 
        </span><span class="s3">// and higherBound inclusive.</span><span class="s1"> 
        </span><span class="s0">int </span><span class="s1">lowerBound = Integer.parseInt(</span><span class="s2">&quot;1&quot;</span><span class="s1">); 
        </span><span class="s0">int </span><span class="s1">higherBound = Integer.parseInt(</span><span class="s2">&quot;30&quot;</span><span class="s1">); 
        UniformIntegerGenerator uniformIntegerGenerator = </span><span class="s0">new </span><span class="s1">UniformIntegerGenerator(lowerBound, higherBound); 
 
        </span><span class="s3">// Zipfian generator generates zipfian distributed integers between min and max with</span><span class="s1"> 
        </span><span class="s3">// zipfian constant zipfConstant.</span><span class="s1"> 
        </span><span class="s0">long </span><span class="s1">min = </span><span class="s4">100</span><span class="s1">; 
        </span><span class="s0">long </span><span class="s1">max = </span><span class="s4">500</span><span class="s1">; 
        </span><span class="s0">double </span><span class="s1">zipfianConstant = </span><span class="s4">0.9</span><span class="s1">; 
        ZipfianGenerator zipfianGenerator = </span><span class="s0">new </span><span class="s1">ZipfianGenerator(min, max, zipfianConstant); 
 
        </span><span class="s0">for </span><span class="s1">(</span><span class="s0">int </span><span class="s1">i=</span><span class="s4">0</span><span class="s1">; i&lt;</span><span class="s4">10000</span><span class="s1">; ++i) { 
            </span><span class="s0">int </span><span class="s1">random = uniformIntegerGenerator.nextInt(); 
            </span><span class="s0">long </span><span class="s1">randomz = zipfianGenerator.nextLong(); 
            ps.setInt(</span><span class="s4">1</span><span class="s1">, random); 
            ps.setLong(</span><span class="s4">2</span><span class="s1">, randomz); 
            ps.execute(); 
        } 
 
        ps.close(); 
        connection.commit(); 
        connection.close(); 
    } 
} 
</span></pre>
</body>
</html>